tinymce.PluginManager.add("wprainbow",function(b){function f(){var a=b.dom.getParent(b.selection.getNode(),"PRE");d.disabled(!a);d.value(b.dom.getAttrib(a,"data-language"));e&&e.disabled(!a)}function g(a){b.dom.setAttrib(b.dom.getParent(b.selection.getNode(),"PRE"),"data-language",a)}function h(){var a=b.dom.getParent(b.selection.getNode(),"PRE"),c=b.dom.getAttrib(a,"data-language"),a=b.dom.getAttrib(a,"data-line")||0;b.windowManager.open({title:wprainbow.l10n.code_properties,body:[{type:"listbox",
name:"language",size:40,label:wprainbow.l10n.code_language,values:wprainbow.languages,value:c},{type:"checkbox",name:"enable_line_numbering",label:wprainbow.l10n.line_numbers,value:"1",checked:"-1"!=a},{type:"textbox",name:"starting_line",label:wprainbow.l10n.starting_line,value:a}],onsubmit:function(a){g(a.data.language);console.log();var c=-1;a.data.enable_line_numbering&&(c=Math.abs(a.data.starting_line),isNaN(c)&&(c=1));a=c;b.dom.setAttrib(b.dom.getParent(b.selection.getNode(),"PRE"),"data-line",
a)}})}var d,e;b.addButton("wprainbow",{type:"listbox",text:wprainbow.l10n.code_language,tooltip:wprainbow.l10n.code_language,menu_button:!0,classes:"widget btn fixed-width",onselect:function(a){g(this.value())},values:wprainbow.languages,onPostRender:function(){d=this;b.on("nodechange",function(a){f()});for(var a in wprainbow.languages){var c=wprainbow.languages[a].value;c&&b.contentStyles.push('pre[data-language="'+c+'"]:before { content:"'+wprainbow.languages[a].text+'" }')}}});wprainbow.enable_line_numbering&&
b.addButton("wprainbow_codecontrol",{tooltip:wprainbow.l10n.code_properties,onclick:h,onPostRender:function(){e=this;b.on("nodechange",function(a){f()})}})});
